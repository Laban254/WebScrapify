{% extends 'base.html' %}

{% block content %}

<!-- Include Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>

<!-- Initialize Firebase -->
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDhUTnOI21g2Rfmz-xg7IyhXOe1JxCByL0",
    authDomain: "webscrapify.firebaseapp.com",
    projectId: "webscrapify",
    storageBucket: "webscrapify.appspot.com",
    messagingSenderId: "991657109883",
    appId: "1:991657109883:web:bf3d5bcfec2a0e7a6275de",
  };
  firebase.initializeApp(firebaseConfig);

  // Firebase authentication functions
  function signInWithGoogle() {
    const provider = new firebase.auth.GoogleAuthProvider();
    firebase.auth().signInWithPopup(provider)
      .then((result) => {
        const user = result.user;
        // Send user credentials to Django backend
        // Example: sendCredentialsToBackend(user.uid, user.email);
      })
      .catch((error) => {
        console.error('Error signing in with Google:', error.code, error.message);
      });
  }
</script>

<!-- HTML content -->
<button onclick="signInWithGoogle()">Sign in with Google</button>

{% endblock %}
{% comment %} <!-- login.html -->
{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <h2>Login</h2>
        <form id="sign-in-form">
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" class="form-control" id="email" required>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" class="form-control" id="password" required>
            </div>
            <button type="submit" class="btn btn-primary">Sign In</button>
        </form>

        <div class="mt-3">
            <button id="google-sign-in" class="btn btn-danger">Sign in with Google</button>
            <button id="microsoft-sign-in" class="btn btn-primary">Sign in with Microsoft</button>
        </div>
    </div>
</div>

<script>
    document.getElementById('sign-in-form').addEventListener('submit', function(event) {
        event.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        firebase.auth().signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
                const user = userCredential.user;
                user.getIdToken().then((idToken) => {
                    document.cookie = `idToken=${idToken};path=/`;
                    window.location.href = '/protected/';
                });
            })
            .catch((error) => {
                console.error('Error signing in:', error.code, error.message);
            });
    });

    document.getElementById('google-sign-in').addEventListener('click', function() {
        const provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithPopup(provider)
            .then((result) => {
                const user = result.user;
                user.getIdToken().then((idToken) => {
                    document.cookie = `idToken=${idToken};path=/`;
                    window.location.href = '/protected/';
                });
            })
            .catch((error) => {
                console.error('Error signing in with Google:', error.code, error.message);
            });
    });

    document.getElementById('microsoft-sign-in').addEventListener('click', function() {
        const provider = new firebase.auth.OAuthProvider('microsoft.com');
        firebase.auth().signInWithPopup(provider)
            .then((result) => {
                const user = result.user;
                user.getIdToken().then((idToken) => {
                    document.cookie = `idToken=${idToken};path=/`;
                    window.location.href = '/protected/';
                });
            })
            .catch((error) => {
                console.error('Error signing in with Microsoft:', error.code, error.message);
            });
    });
</script>
{% endblock %} {% endcomment %}
